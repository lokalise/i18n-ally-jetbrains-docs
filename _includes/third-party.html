{% if site.heap_app_id != blank %}
    <script type="text/javascript">
        window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])};
        heap.load("{{ site.heap_app_id }}");
    </script>
{% endif %}

<script src="https://embed.small.chat/T01QRMV2NR4C0228H4KW2K.js" async></script>

{% if site.ga_measurement_id != blank %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.ga_measurement_id }}"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '{{ site.ga_measurement_id }}');
    </script>
{% endif %}

{% if 1 == 0 %}
<script type="text/javascript">
    (function () {
        const params = (new URL(document.location)).searchParams;

        if (heap && typeof heap.identify == 'function') {
            heap.identify(params.get('chatId'));
        }

        if (typeof gtag == 'function') {
            gtag('config', '{{ site.ga_measurement_id }}', { 'user_id': params.get('chatId') });
        }
    })();
</script>
{% endif %}


<script>
    window.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.js-install-btn').forEach(link => {
            const uiSource = link.getAttribute('data-ui-source') ? link.getAttribute('data-ui-source') : 'unknown';
            const textContent = link.textContent ? link.textContent : 'unknown';
            const countClick = function() {
                if (heap && typeof heap.identify == 'function') {
                    heap.track('Click on install button', { uiSource, textContent});
                }

                if (typeof gtag == 'function') {
                    gtag('event', 'Click on install button', { uiSource, textContent });
                }
            };

            link.addEventListener('click', countClick);
            link.addEventListener('auxclick', countClick);
            link.addEventListener('contextmenu', countClick);
        });
    });
</script>